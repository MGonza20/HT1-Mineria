---
title: "HT01"
author: "Sara, Cristian, Guillermo"
date: "2023-02-02"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

``` {r}
movies <- read.csv("movies.csv")
```

## Cristian
### 1. Haga una exploración rápida de sus datos, para eso haga un resumen de su conjunto de datos.
``` {r}
summary(movies)
```

## Sara
### 2. Diga el tipo de cada una de las variables (cualitativa ordinal o nominal, cuantitativa continua, cuantitativa discreta) 
```{r}
str(movies)
```
### Tipo de las variables
* id: cualitativa ordinal  
* popularity: cuantitativa continua  
* budget: cuantitativa discreta  
* revenue: cuantitativa discreta  
* original_title: cualitativa nominal  
* originalLanguage: cualitativa nominal  
* title: cualitativa nominal  
* homePage: cualitativa nominal  
* video: cualitativa nominal  
* director: cualitativa nominal  
* runtime: cuantitativa discreta
* genres: cualitativa nominal
* genresAmount: cuantitativa discreta  
* productionCompany: cualitativa nominal  
* productionCoAmount: cuantitativa discreta  
* productionCompantCountry: cualitativa nominal  
* productionCountry: cualitativa nominal  
* productionCountriesAmount: cuantitativa discreta  
* releaseDate: cualitativa nominal  
* voteCount: cuantitativa discreta  
* voteAvg: cuantitativa continua  
* actors: cualitativa nominal  
* actorsPopularity: cuantitativa continua
* actorsCharacter: cualitativa nominal  
* actorsAmount: cuantitativa discreta  
* castWomenAmount: cuantitativa discreta  
* castMenAmount: cuantitativa discreta  

### 3. Investigue si las variables cuantitativas siguen una distribución normal y haga una tabla de frecuencias de las variables cualitativas. Explique todos los resultados.

### popularity 
```{r}
library(nortest)
qqnorm(movies$popularity)
qqline(movies$popularity, col="red")
normP <- lillie.test(movies$popularity)
pnormP <- normP$p.value
```
norm: `r pnormP`

### budget 
```{r}
library(nortest)
qqnorm(movies$budget)
qqline(movies$budget, col="red")
normBud <- lillie.test(movies$budget)
pnormBud <- normBud$p.value
```
norm: `r pnormBud`

### revenue 
```{r}
library(nortest)
qqnorm(movies$revenue)
qqline(movies$revenue, col="red")
normRev <- lillie.test(movies$revenue)
pnormRev <- normRev$p.value
```
norm: `r pnormRev`

### runtime 
```{r}
library(nortest)
qqnorm(movies$runtime)
qqline(movies$runtime, col="red")
normRun <- lillie.test(movies$runtime)
pnormRun <- normRun$p.value
```
norm: `r pnormRun`

### genresAmount
```{r}
library(nortest)
qqnorm(movies$genresAmount)
qqline(movies$genresAmount, col="red")
normGenAm <- lillie.test(movies$genresAmount)
pnormGenAm <- normGenAm$p.value
```
norm: `r pnormGenAm`

## Tabla de frecuencias para variables cualitativas

### original_title
```{r}
#table(movies$originalTitle)
```

### 4.1 ¿Cuáles son las 10 películas que contaron con más presupuesto?
```{r}
moviesP <- movies[order(-movies$budget),]
head(moviesP$title, 10)
```



## Guillermo

### 4.4 ¿Cuál es la peor película de acuerdo a los votos de todos los usuarios? 
``` {r}
min_votes <- min(movies$voteAvg)
movie <- movies[movies$voteAvg == min_votes,"title"]
```
La pelicula con menos votos es: `r movie`

## 4.5 ¿Cuántas  películas  se  hicieron  en  cada  año?  ¿En  qué  año  se  hicieron  más películas? Haga un gráfico de barras 

``` {r}
dates <- as.POSIXct(movies[,"releaseDate"], format = "%Y-%m-%d")
years <- sort(c(format(dates, format="%Y")))
release_years = sort(table(years), decreasing = TRUE)
print(summary.factor(factor(years)))
```
```{r}

barplot(table(years))
```
El año con más peliculas estrenadas fue 2021.


## Cristian

### 4.11 ¿Cómo se correlacionan los presupuestos con los ingresos? ¿Los altos presupuestos significan altos ingresos? Haga los gráficos que necesite, histograma, diagrama de dispersión
``` {r}
hist(movies$budget, main = "¿Cómo se correlacionan los presupuestos con los ingresos?")
```

### 4.15 ¿A qué género principal pertenecen las películas más largas? (genres, runtime)
``` {r}

```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
