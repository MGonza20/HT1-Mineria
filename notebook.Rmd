---
title: "HT01"
author: "Sara, Cristian, Guillermo"
date: "2023-02-02"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


``` {r}
movies <- read.csv("movies.csv")
```

## Cristian
### 1. Haga una exploración rápida de sus datos, para eso haga un resumen de su conjunto de datos.
``` {r}
summary(movies)
```

## Sara
### 2. Diga el tipo de cada una de las variables (cualitativa ordinal o nominal, cuantitativa continua, cuantitativa discreta) 
```{r}
str(movies)
```
### Tipo de las variables
* id: cualitativa ordinal  
* popularity: cuantitativa continua  
* budget: cuantitativa discreta  
* revenue: cuantitativa discreta  
* original_title: cualitativa nominal  
* originalLanguage: cualitativa nominal  
* title: cualitativa nominal  
* homePage: cualitativa nominal  
* video: cualitativa nominal  
* director: cualitativa nominal  
* runtime: cuantitativa discreta
* genres: cualitativa nominal
* genresAmount: cuantitativa discreta  
* productionCompany: cualitativa nominal  
* productionCoAmount: cuantitativa discreta  
* productionCompantCountry: cualitativa nominal  
* productionCountry: cualitativa nominal  
* productionCountriesAmount: cuantitativa discreta  
* releaseDate: cuantitativa discreta
* voteCount: cuantitativa discreta  
* voteAvg: cuantitativa continua  
* actors: cualitativa nominal  
* actorsPopularity: cuantitativa continua
* actorsCharacter: cualitativa nominal  
* actorsAmount: cuantitativa discreta  
* castWomenAmount: cuantitativa discreta  
* castMenAmount: cuantitativa discreta  






### 4.4 ¿Cuál es la peor película de acuerdo a los votos de todos los usuarios? 
``` {r}
min_votes <- min(movies$voteAvg)
movie <- movies[movies$voteAvg == min_votes,"title"]
```
La pelicula con menos votos es: `r movie`

## 4.5 ¿Cuántas  películas  se  hicieron  en  cada  año?  ¿En  qué  año  se  hicieron  más películas? Haga un gráfico de barras 

``` {r}
dates <- as.POSIXct(movies[,"releaseDate"], format = "%Y-%m-%d")
years <- sort(c(format(dates, format="%Y")))
release_years = sort(table(years), decreasing = TRUE)
print(summary.factor(factor(years)))
```
```{r}
barplot(table(years))
```
El año con más peliculas estrenadas fue 2021.

## 4.6 ¿Cuál es el género principal de las 20 películas más recientes? ¿Cuál es el género principal que predomina en el conjunto de datos? Represéntelo usando un gráfico

``` {r}
recent_20_movies_genres = head(movies[order(movies$releaseDate, decreasing = TRUE),"genres"],20)
genres_factor <- factor()
for (g in recent_20_movies_genres){
  splitted = unlist(strsplit(g, "|", fixed=T))
  new_factor <- factor(splitted)
  genres_factor <- append(genres_factor, new_factor)
}
f <- unlist(genres_factor)
print(summary.factor(f))
barplot(table(f), horiz = T)

```

El genero principal de las 20 peliculas más recientes es drama y comedia.


``` {r}
movies_genres = movies[order(movies$releaseDate, decreasing = TRUE),"genres"]
genres_factor <- factor()
for (g in movies_genres){
  splitted = unlist(strsplit(g, "|", fixed=T))
  new_factor <- factor(splitted)
  genres_factor <- append(genres_factor, new_factor)
}
f <- unlist(genres_factor)
print(summary.factor(f))
barplot(table(f), horiz = T)

```
El genero que mas predomina es Drama, con 3789 peliculas.


## 4.7 ¿Las películas de qué genero principal obtuvieron mayores ganancias? 
``` {r}
revenue_drama = movies[movies$genres,"revenue"]
```


## 4.8 ¿La cantidad de actores influye en los ingresos de las películas?¿se han hecho 
películas con más actores en los últimos años? 
``` {r}
actor_q = movies[, "actorsAmount"]
revenue = movies[, "revenue"]
q = cor(actor_q, revenue, method="pearson")
library("ggpubr")
ggscatter(movies, x = "actorsAmount", y = "revenue", 
          add = "reg.line", conf.int = TRUE, 
          cor.coef = TRUE, cor.method = "pearson",
          xlab = "Cantidad de Actores", ylab = "Ganancia")
```

Dado un coeficiente p de 0.051 podemos descartar una correlación entre la cantidad de actores y las ganancias de las películas.

## 4.9 ¿Es posible que la cantidad de hombres y mujeres en el  reparto influya en la 
popularidad y los ingresos de las películas? 

``` {r}
#actor_w = movies[, "castWomenAmount"]
#actor_m = movies[, "castMenAmount"]

#revenue = movies[, "revenue"]
#popularity = movies[, "popularity"]

library("ggpubr")
ggscatter(movies, x = "castWomenAmount", y = "popularity", 
          add = "reg.line", conf.int = TRUE, 
          cor.coef = TRUE, cor.method = "pearson",
          xlab = "Cantidad de Mujeres", ylab = "Ganancia")
```


## Cristian

### 4.11 ¿Cómo se correlacionan los presupuestos con los ingresos? ¿Los altos presupuestos significan altos ingresos? Haga los gráficos que necesite, histograma, diagrama de dispersión
``` {r}
hist(movies$budget, main = "¿Cómo se correlacionan los presupuestos con los ingresos?")
```

### 4.15 ¿A qué género principal pertenecen las películas más largas? (genres, runtime)
``` {r}

```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
